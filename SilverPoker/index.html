<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>银姐快乐牌</title>
    <style>
        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 10px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background: url('/static/background.jpg') no-repeat center center fixed;
            background-size: cover;
            position: relative;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.8);
            z-index: 0;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
            flex: 1;
            position: relative;
            z-index: 1;
        }
        
        .game-header {
            text-align: center;
            margin: 30px 0 15px;
        }
        
        .game-header h1 {
            margin: 0;
            font-size: 36px;
            display: inline-block;
            background: linear-gradient(45deg, #9370DB, #4CAF50, #FF69B4);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 10px rgba(255, 105, 180, 0.3);
            padding: 15px 30px;
            position: relative;
            animation: gradientFlow 8s ease infinite;
        }
        
        .game-header h1::first-letter {
            font-size: 1.8em;
            font-family: "LiSu", "隶书", "STLiti", "华文隶书", cursive;
            background: linear-gradient(45deg, #FFD700, #FFA500, #FF4500);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 
                2px 2px 4px rgba(255, 215, 0, 0.5),
                -2px -2px 4px rgba(255, 165, 0, 0.3);
            transform: rotate(-5deg);
            display: inline-block;
            animation: 
                silverGlow 2s ease-in-out infinite,
                gradientFlow 8s ease infinite,
                floatEffect 3s ease-in-out infinite;
            position: relative;
            margin-right: 5px;
        }
        
        .game-header h1::before {
            content: '';
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            background: linear-gradient(45deg, #9370DB, #4CAF50, #FF69B4);
            background-size: 300% 300%;
            border-radius: 5px;
            z-index: -1;
            filter: blur(15px);
            opacity: 0.3;
            animation: gradientFlow 8s ease infinite;
        }
        
        @keyframes gradientFlow {
            0% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
            100% {
                background-position: 0% 50%;
            }
        }
        
        @keyframes silverGlow {
            0%, 100% {
                filter: brightness(1);
                transform: scale(1);
            }
            50% {
                filter: brightness(1.3);
                transform: scale(1.05);
            }
        }
        
        @keyframes floatEffect {
            0%, 100% {
                transform: rotate(-5deg) translateY(0px);
            }
            50% {
                transform: rotate(-5deg) translateY(-5px);
            }
        }
        
        #player-number {
            margin-top: 10px;
            font-size: 18px;
            color: #666;
            text-align: center;
        }
        
        .room-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .room-controls input, .room-controls select {
            flex: 1;
            min-width: 120px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        
        .button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            color: white;
            font-size: 16px;
            cursor: pointer;
            touch-action: manipulation;
            min-height: 44px;
            transition: all 0.3s ease;
        }
        
        .button:disabled {
            background: #cccccc !important;
            transform: none !important;
            box-shadow: none !important;
        }
        
        /* 开始游戏按钮 - 深蓝到天蓝渐变 */
        #start-game {
            background: linear-gradient(45deg, #1E90FF, #00BFFF);
        }
        #start-game:hover {
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(30, 144, 255, 0.5);
        }
        
        /* 修改名称按钮 - 橙色到金色渐变 */
        #change-name {
            background: linear-gradient(45deg, #FFA500, #FFD700);
        }
        #change-name:hover {
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(255, 165, 0, 0.5);
        }
        
        /* 过牌按钮 - 靛蓝到青色渐变 */
        #pass {
            background: linear-gradient(45deg, #4B0082, #00CED1);
        }
        #pass:hover {
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(75, 0, 130, 0.5);
        }
        
        /* 出牌按钮 - 红色到橙色渐变 */
        #play-cards {
            background: linear-gradient(45deg, #DC143C, #FF8C00);
        }
        #play-cards:hover {
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(220, 20, 60, 0.5);
        }
        
        /* 叉牌按钮 - 紫罗兰到蓝绿渐变 */
        #fork {
            background: linear-gradient(45deg, #8A2BE2, #20B2AA);
        }
        #fork:hover {
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(138, 43, 226, 0.5);
        }
        
        /* 勾牌按钮 - 深绿到青绿渐变 */
        #hook {
            background: linear-gradient(45deg, #2E8B57, #98FB98);
        }
        #hook:hover {
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(46, 139, 87, 0.5);
        }
        
        .game-area {
            background-color: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .game-info {
            margin-bottom: 15px;
        }
        
        .game-info div {
            margin-bottom: 8px;
            font-size: 16px;
        }
        
        .cards-area {
            margin: 15px 0;
            min-height: 100px;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            padding: 10px;
            position: relative;
        }
        
        .card {
            width: 45px;
            height: 65px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 500;
            background: linear-gradient(135deg, #ffffff 0%, #f8f8f8 100%);
            cursor: grab;
            user-select: none;
            touch-action: manipulation;
            box-shadow: 
                0 2px 4px rgba(0, 0, 0, 0.1),
                inset 0 1px 2px rgba(255, 255, 255, 0.9);
            transition: transform 0.15s ease, box-shadow 0.15s ease;
            position: relative;
            overflow: hidden;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.4) 0%, rgba(255, 255, 255, 0) 100%);
            border-radius: 7px;
        }
        
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 
                0 4px 8px rgba(0, 0, 0, 0.15),
                inset 0 1px 2px rgba(255, 255, 255, 0.9);
        }
        
        .card.selected {
            border-color: rgba(76, 175, 80, 0.5);
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            transform: translateY(-5px);
            box-shadow: 
                0 5px 15px rgba(76, 175, 80, 0.3),
                inset 0 1px 2px rgba(255, 255, 255, 0.9);
        }
        
        .card.red {
            color: rgba(255, 0, 0, 0.85);
            text-shadow: 0 1px 1px rgba(255, 255, 255, 0.5);
        }
        
        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 15px;
        }
        
        .controls button {
            flex: 1;
            min-width: 100px;
            max-width: 200px;
        }
        
        .player-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        .player {
            flex: 1;
            min-width: 100px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            text-align: center;
            background-color: white;
            position: relative;
            overflow: visible;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        /* 当前玩家样式 */
        .player.current {
            border: 2px solid #4CAF50;
            background: linear-gradient(to bottom, #e8f5e9, #fff);
            font-weight: bold;
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(76, 175, 80, 0.2);
        }
        
        /* 自己的玩家框样式 */
        .player.self {
            font-family: "Microsoft YaHei", "微软雅黑", sans-serif;
            font-weight: bold;
            border: 2px solid #1E88E5;
            background: linear-gradient(to bottom, #E3F2FD, #fff);
            box-shadow: 0 4px 8px rgba(30, 136, 229, 0.2);
        }
        
        /* 玩家名称样式 */
        .player .name {
            font-size: 16px;
            margin-bottom: 5px;
            color: #333;
        }
        
        /* 玩家卡牌数量样式 */
        .player .card-count {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .player .score {
            margin-top: 5px;
            font-size: 14px;
            color: #666;
            padding: 3px 0;
            border-top: 1px dashed #eee;
        }
        
        /* 叉牌状态样式 */
        .player.forking {
            border-color: #f44336;
            border-width: 3px;
            background: linear-gradient(to bottom, #ffebee, #fff);
            animation: forkPulse 0.8s infinite;
            transform: scale(1.05);
            z-index: 2;
        }
        
        /* 勾牌状态样式 */
        .player.hooking {
            border-color: #2196F3;
            border-width: 3px;
            background: linear-gradient(to bottom, #e3f2fd, #fff);
            animation: hookPulse 0.8s infinite;
            transform: scale(1.05);
            z-index: 2;
        }
        
        @keyframes forkPulse {
            0% {
                box-shadow: 
                    0 0 0 0 rgba(244, 67, 54, 0.8),
                    0 0 0 0 rgba(244, 67, 54, 0.5);
            }
            25% {
                box-shadow: 
                    0 0 0 15px rgba(244, 67, 54, 0),
                    0 0 0 25px rgba(244, 67, 54, 0);
            }
            100% {
                box-shadow: 
                    0 0 0 0 rgba(244, 67, 54, 0),
                    0 0 0 0 rgba(244, 67, 54, 0);
            }
        }
        
        @keyframes hookPulse {
            0% {
                box-shadow: 
                    0 0 0 0 rgba(33, 150, 243, 0.8),
                    0 0 0 0 rgba(33, 150, 243, 0.5);
            }
            25% {
                box-shadow: 
                    0 0 0 15px rgba(33, 150, 243, 0),
                    0 0 0 25px rgba(33, 150, 243, 0);
            }
            100% {
                box-shadow: 
                    0 0 0 0 rgba(33, 150, 243, 0),
                    0 0 0 0 rgba(33, 150, 243, 0);
            }
        }
        
        /* 添加砖头动画样式 */
        .brick {
            position: absolute;
            width: 30px;
            height: 15px;
            background-color: #8B4513;
            border-radius: 2px;
            z-index: 1000;
            pointer-events: none;
            animation: throwBrick 0.5s ease-out forwards;
        }
        
        @keyframes throwBrick {
            0% {
                transform: scale(0.5) rotate(0deg);
            }
            100% {
                transform: scale(1) rotate(360deg);
            }
        }
        
        #messages {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            background-color: #f8f8f8;
            max-height: 100px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        @media (max-width: 480px) {
            body {
                padding: 5px;
            }
            
            .game-header h1 {
                font-size: 24px;
                padding: 10px 20px;
            }
            
            .card {
                width: 40px;
                height: 58px;
                font-size: 18px;
                border-radius: 6px;
            }
            
            .card::before {
                border-radius: 5px;
            }
            
            .button {
                padding: 8px 15px;
                font-size: 14px;
            }
            
            .controls button {
                min-width: 80px;
            }
            
            .player {
                min-width: 80px;
                padding: 8px;
                font-size: 14px;
            }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        /* 添加火焰特效样式 */
        .fire-effect {
            position: absolute;
            width: 140%;
            height: 140%;
            top: -20%;
            left: -20%;
            pointer-events: none;
            z-index: 1;
            animation: fireAnimation 2s ease-in-out;
        }
        
        .fire-effect::before,
        .fire-effect::after {
            content: '';
            position: absolute;
            left: 50%;
            bottom: 20%;
            transform: translateX(-50%);
            width: 80%;
            height: 80%;
            background: 
                radial-gradient(circle at center, rgba(255,160,0,0) 0%, rgba(255,160,0,0) 50%, rgba(255,160,0,0.4) 100%),
                radial-gradient(circle at center, rgba(255,80,0,0.8) 0%, rgba(255,80,0,0) 60%),
                radial-gradient(circle at center, rgb(255,230,110) 0%, rgba(255,230,110,0) 70%);
            filter: blur(5px);
            border-radius: 50% 50% 35% 35% / 50% 50% 25% 25%;
            animation: flameMove 0.5s ease-out infinite alternate;
        }
        
        .fire-effect::after {
            width: 60%;
            height: 60%;
            bottom: 40%;
            background: 
                radial-gradient(circle at center, rgba(255,230,110,1) 0%, rgba(255,230,110,0) 50%),
                radial-gradient(circle at center, rgba(255,80,0,0.8) 0%, rgba(255,80,0,0) 60%);
            animation: flameMove 0.7s ease-out infinite alternate-reverse;
        }
        
        @keyframes flameMove {
            0% {
                transform: translateX(-50%) scaleY(1) scaleX(1);
                filter: blur(5px);
            }
            100% {
                transform: translateX(-50%) scaleY(1.1) scaleX(0.9);
                filter: blur(7px);
            }
        }
        
        @keyframes fireAnimation {
            0% { opacity: 0; transform: scale(0.8); }
            20% { opacity: 1; transform: scale(1); }
            80% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(0.8); }
        }
        
        /* 添加文字动画样式 */
        .hot-text {
            position: absolute;
            top: 65%;  /* 调整到下方 */
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            font-size: 18px;
            text-shadow: 
                0 0 4px rgba(255, 100, 0, 0.8),
                0 0 8px rgba(255, 50, 0, 0.6),
                2px 2px 4px rgba(0, 0, 0, 0.5);
            opacity: 0;
            animation: textAnimation 2s ease-in-out;
            pointer-events: none;
            z-index: 2;
            white-space: nowrap;
        }
        
        @keyframes textAnimation {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            20% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
            80% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
        }
        
        /* 添加流泪表情样式 */
        .cry-emoji {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            opacity: 0;
            pointer-events: none;
            z-index: 2;
            animation: cryAnimation 1.5s ease-out forwards;
        }
        
        @keyframes cryAnimation {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            20% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
            80% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8) translateY(20px); }
        }
        
        /* 添加发怒表情样式 */
        .angry-emoji {
            position: absolute;
            top: 35%;  /* 调整到上方 */
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            opacity: 0;
            pointer-events: none;
            z-index: 2;
            animation: angryAnimation 2s ease-out forwards;
        }
        
        @keyframes angryAnimation {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            20% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
            80% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8) translateY(-20px); }
        }
        
        /* 添加银姐换装按钮样式 */
        #change-background {
            background: linear-gradient(45deg, #FF69B4, #9370DB);
            border: none;
            color: white;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        #change-background:hover {
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(147, 112, 219, 0.5);
        }
        
        /* 添加衣物表情动画样式 */
        .clothes-emoji {
            position: absolute;
            font-size: 20px;
            pointer-events: none;
            z-index: 1000;
            animation: flyClothes 1s ease-out forwards;
        }
        
        @keyframes flyClothes {
            0% {
                opacity: 1;
                transform: scale(0.5) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: scale(1.5) rotate(360deg) translate(var(--tx), var(--ty));
            }
        }
        
        /* 创建房间按钮 - 紫色到粉色渐变 */
        #create-room {
            background: linear-gradient(45deg, #9932CC, #FF69B4);
        }
        #create-room:hover {
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(153, 50, 204, 0.5);
        }

        /* 加入房间按钮 - 蓝绿到青色渐变 */
        #join-room {
            background: linear-gradient(45deg, #20B2AA, #7FFFD4);
        }
        #join-room:hover {
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(32, 178, 170, 0.5);
        }

        /* 选择牌数下拉框 - 金色到琥珀色渐变 */
        #deck-count {
            background: linear-gradient(45deg, #DAA520, #D2691E);
            color: white;
            cursor: pointer;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 16px;
            appearance: none;
            -webkit-appearance: none;
            position: relative;
            text-align: center;
            text-align-last: center;
        }
        #deck-count:hover {
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(218, 165, 32, 0.5);
        }
        #deck-count option {
            background: #DAA520;
            color: white;
        }

        /* 房间号输入框样式 */
        #room-id {
            border: 2px solid transparent;
            border-image: linear-gradient(45deg, #FF8C00, #FFD700) 1;
            background: white;
            color: #333;
            transition: all 0.3s ease;
        }
        #room-id:focus {
            outline: none;
            box-shadow: 0 0 10px rgba(255, 140, 0, 0.3);
            border-image: linear-gradient(45deg, #FFD700, #FF8C00) 1;
        }

        .last-cards h3 {
            color: #444;
            font-size: 18px;
            padding: 8px 0;
            margin: 0 0 10px 0;
            border-bottom: 2px solid #ddd;
            position: relative;
        }

        .last-cards h3::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 50px;
            height: 2px;
            background: linear-gradient(90deg, #666, #ddd);
        }

        .card.dragging {
            opacity: 0.8;
            cursor: grabbing;
            transform: scale(1.1) rotate(2deg);
            z-index: 1000;
            box-shadow: 
                0 8px 16px rgba(0, 0, 0, 0.2),
                inset 0 1px 2px rgba(255, 255, 255, 0.9);
            transition: none;
        }

        /* 拖拽目标位置指示器 */
        .card-drop-indicator {
            width: 4px;
            height: 70px;
            background: linear-gradient(to bottom, 
                rgba(76, 175, 80, 0.8) 0%,
                rgba(76, 175, 80, 1) 50%,
                rgba(76, 175, 80, 0.8) 100%);
            border-radius: 2px;
            position: absolute;
            box-shadow: 0 0 8px rgba(76, 175, 80, 0.5);
            transition: all 0.1s ease;
            z-index: 999;
        }

        /* 刷新按钮 - 绿色到青色渐变 */
        #refresh-game {
            background: linear-gradient(45deg, #32CD32, #00CED1);
        }
        #refresh-game:hover {
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(50, 205, 50, 0.5);
        }

        /* 选择线路按钮 - 蓝紫渐变 */
        #select-server {
            background: linear-gradient(45deg, #4169E1, #9370DB);
        }
        #select-server:hover {
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(65, 105, 225, 0.5);
        }

        /* 线路选择对话框样式 */
        .server-dialog {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.2);
            z-index: 1000;
            min-width: 300px;
        }

        .server-dialog h3 {
            margin-top: 0;
            color: #333;
            text-align: center;
        }

        .server-option {
            display: block;
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: none;
            border-radius: 5px;
            background: #f0f0f0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .server-option:hover {
            background: #e0e0e0;
        }

        .custom-server-input {
            width: 100%;
            padding: 8px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            display: none;
        }

        .server-dialog-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 999;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="game-header">
            <h1>银姐快乐牌</h1>
            <button id="change-background" class="button" style="margin-top: 10px;">银姐换装</button>
            <div id="player-number"></div>
        </div>
        <div id="message"></div>
        <div id="game-status"></div>
        
        <div id="login-section">
            <div class="room-controls">
                <select id="deck-count" class="button">
                    <option value="1">1副牌</option>
                    <option value="2">2副牌</option>
                </select>
                <button id="select-server" class="button">选择线路</button>
                <button id="create-room" class="button">创建房间</button>
                <input type="text" id="room-id" placeholder="输入房间号">
                <button id="join-room" class="button">加入房间</button>
            </div>
        </div>
        
        <div id="game-section" style="display: none;">
            <div id="room-info" class="game-info"></div>
            <button id="start-game" class="button">开始游戏</button>
            <button id="change-name" class="button" style="margin-left: 10px;">修改名称</button>
            <button id="refresh-game" class="button" style="margin-left: 10px;">刷新</button>
            
            <div class="player-list" id="player-list">
                <!-- 玩家信息将动态添加 -->
            </div>
            
            <div class="last-cards" id="last-cards">
                <h3>上一手牌</h3>
                <!-- 上一手牌将动态添加 -->
            </div>
            
            <div id="player-cards" class="cards-area"></div>
            
            <div id="game-controls" class="controls">
                <button id="pass" class="button">过</button>
                <button id="play-cards" class="button">出牌</button>
                <button id="fork" class="button" style="display: none;">叉牌</button>
                <button id="hook" class="button" style="display: none;">勾牌</button>
            </div>
        </div>
    </div>
    
    <div class="server-dialog-overlay"></div>
    <div class="server-dialog">
        <h3>选择服务器线路</h3>
        <button class="server-option" data-server="hk">线路1: 香港服务器</button>
        <button class="server-option" data-server="tx">线路2: 腾讯服务器</button>
        <button class="server-option" data-server="custom">线路3: 自定义线路</button>
        <input type="text" class="custom-server-input" placeholder="请输入服务器地址">
    </div>
    
    <script>
        let ws = null;
        let selectedCards = new Set();
        let currentPlayerIndex = -1;
        let playerCount = 0;
        let lastJoinClickTime = 0;
        let currentServer = null;  // 存储当前选择的服务器

        const SERVER_URLS = {
            'hk': 'wss://silverpoker.redheartco.shop/game',  // 香港服务器地址
            'tx': 'wss://django-6h56-136494-9-1337520003.sh.run.tcloudbase.com/game'  // 腾讯服务器使用默认本地服务器
        };
        
        function showMessage(msg, isError = true) {
            const msgEl = document.getElementById('message');
            msgEl.textContent = msg;
            msgEl.style.color = isError ? '#f44336' : '#4CAF50';
            setTimeout(() => msgEl.textContent = '', 3000);
        }
        
        function isRedCard(card) {
            return card.startsWith('♥') || card.startsWith('♦');
        }
        
        document.getElementById('select-server').onclick = () => {
            document.querySelector('.server-dialog').style.display = 'block';
            document.querySelector('.server-dialog-overlay').style.display = 'block';
        };

        document.querySelector('.server-dialog-overlay').onclick = () => {
            document.querySelector('.server-dialog').style.display = 'none';
            document.querySelector('.server-dialog-overlay').style.display = 'none';
        };

        document.querySelectorAll('.server-option').forEach(button => {
            button.onclick = () => {
                const serverType = button.dataset.server;
                if (serverType === 'custom') {
                    document.querySelector('.custom-server-input').style.display = 'block';
                } else {
                    currentServer = SERVER_URLS[serverType];
                    document.querySelector('.server-dialog').style.display = 'none';
                    document.querySelector('.server-dialog-overlay').style.display = 'none';
                    if (serverType === 'tx') {
                        showMessage('已选择腾讯服务器（默认线路）', false);
                    } else {
                        showMessage(`已选择${button.textContent}`, false);
                    }
                }
            };
        });

        document.querySelector('.custom-server-input').onchange = (e) => {
            currentServer = e.target.value;
            document.querySelector('.server-dialog').style.display = 'none';
            document.querySelector('.server-dialog-overlay').style.display = 'none';
            showMessage('已设置自定义服务器', false);
        };

        function createWebSocketConnection() {
            if (!currentServer) {
                const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
                return new WebSocket(`${protocol}//${window.location.host}/game`);
            }
            return new WebSocket(currentServer);
        }
        
        document.getElementById('create-room').addEventListener('click', function() {
            const deckCount = document.getElementById('deck-count').value;
            console.log('创建房间，使用牌组数量:', deckCount);  
            ws = createWebSocketConnection();
            ws.onopen = function() {
                ws.send(JSON.stringify({
                    action: 'create_room',
                    deck_count: parseInt(deckCount)
                }));
            };
            ws.onerror = function(error) {
                console.error('WebSocket 错误:', error);
                showMessage('连接错误，请刷新页面重试');
            };
            ws.onmessage = function(event) {
                console.log('收到消息:', event.data);
                const data = JSON.parse(event.data);
                
                switch(data.action) {
                    case 'room_created':
                        document.getElementById('room-info').textContent = '房间号：' + data.room_id;
                        document.getElementById('login-section').style.display = 'none';
                        document.getElementById('game-section').style.display = 'block';
                        showMessage('房间创建成功！', false);
                        alert('创建房间的🦐，请刷新页面后，通过搜索房号加入房间');
                        break;
                        
                    case 'joined_room':
                        if (data.success) {
                            document.getElementById('login-section').style.display = 'none';
                            document.getElementById('game-section').style.display = 'block';
                            document.getElementById('room-info').textContent = '房间号：' + document.getElementById('room-id').value;
                            showMessage('成功加入房间！', false);
                        } else {
                            showMessage(data.message);
                        }
                        break;
                        
                    case 'room_state':
                        playerCount = data.player_count;
                        const roomInfo = document.getElementById('room-info');
                        if (!roomInfo.textContent.includes('玩家')) {
                            roomInfo.textContent += ` (${playerCount}/6 玩家)`;
                        } else {
                            roomInfo.textContent = roomInfo.textContent.replace(/\(\d+\/6 玩家\)/, `(${playerCount}/6 玩家)`);
                        }
                        break;
                        
                    case 'throw_brick':
                        // 接收并显示其他玩家扔砖头的动画
                        showThrowBrickAnimation(data.from_player, data.to_player);
                        break;
                        
                    case 'show_fire':
                        // 接收并显示火焰特效
                        showFireEffect(data.player_index);
                        break;
                        
                    case 'game_state':
                        updateGameState(data);
                        break;
                        
                    case 'game_over':
                        handleGameOver(data);
                        break;
                        
                    case 'show_thanks':
                        alert(data.message);
                        break;
                        
                    case 'error':
                        showMessage(data.message);
                        break;
                }
            };
        });
        
        function updateGameState(data) {
            // 更新手牌
            displayCards(data.cards);
            
            // 更新玩家列表
            updatePlayerList(data);
            
            // 更新上一手牌
            const lastCardsDiv = document.getElementById('last-cards');
            lastCardsDiv.innerHTML = '<h3>上一手牌</h3>';
            
            // // 显示叉牌信息
            // if (data.fork_info) {
            //     lastCardsDiv.innerHTML += `${data.fork_info.player_name} 叉牌：${data.fork_info.cards.join(', ')}<br>`;
            // }
            
            // // 显示勾牌信息
            // if (data.hook_info) {
            //     lastCardsDiv.innerHTML += `${data.hook_info.player_name} 勾牌：${data.hook_info.cards.join(', ')}<br>`;
            // }
            
            // 显示普通出牌信息
            if (data.last_cards) {
                const playerInfo = data.last_cards.player_name ? `${data.last_cards.player_name}：` : '';
                lastCardsDiv.innerHTML += `${playerInfo}${data.last_cards.cards.join(', ')}`;
            } else if (!data.fork_info && !data.hook_info) {
                lastCardsDiv.innerHTML += '无';
            }
            
            // 更新玩家编号显示
            const playerNumberDiv = document.getElementById('player-number');
            const playerName = data.player_names[data.player_number] || `玩家${data.player_number + 1}`;
            playerNumberDiv.textContent = `你是${playerName}`;
            
            // 更新控制按钮
            updateControls(data);
        }
        
        function updatePlayerList(data) {
            const container = document.getElementById('player-list');
            container.innerHTML = '';
            
            for (let i = 0; i < Object.keys(data.player_card_counts).length; i++) {
                const div = document.createElement('div');
                let className = 'player';
                
                // 添加当前玩家高亮
                if (i === currentPlayerIndex) {
                    className += ' current';
                }
                
                // 添加自己的样式
                if (i === data.player_number) {
                    className += ' self';
                }
                
                // 添加叉牌和勾牌的高亮效果
                if (data.fork_player !== undefined && data.player_names[i] === data.player_names[data.fork_player] && data.waiting_for_hook) {
                    className += ' forking';
                }
                if (data.hook_player !== undefined && data.player_names[i] === data.player_names[data.hook_player]) {
                    className += ' hooking';
                }
                
                div.className = className;
                div.dataset.playerIndex = i;
                
                const score = data.scores[i] || 0;
                const name = data.player_names[i] || `玩家${i + 1}`;
                
                // 使用新的HTML结构
                div.innerHTML = `
                    <div class="name">${name}</div>
                    <div class="card-count">${data.player_card_counts[i]}张牌</div>
                    <div class="score">得分: ${score}</div>
                `;
                
                // 为每个玩家方框添加点击事件（除了自己）
                if (i !== data.player_number) {
                    div.style.cursor = 'pointer';
                    div.addEventListener('click', function(e) {
                        ws.send(JSON.stringify({
                            action: 'throw_brick',
                            from_player: data.player_number,
                            to_player: i
                        }));
                    });
                } else {
                    div.style.cursor = 'pointer';
                    div.addEventListener('click', function(e) {
                        ws.send(JSON.stringify({
                            action: 'show_fire',
                            player_index: data.player_number
                        }));
                    });
                }
                
                container.appendChild(div);
            }
        }
        
        function updateControls(data) {
            const playButton = document.getElementById('play-cards');
            const passButton = document.getElementById('pass');
            const forkButton = document.getElementById('fork');
            const hookButton = document.getElementById('hook');
            
            // 清除错误提示
            showMessage('', false);
            
            // 如果玩家没有牌了，且不在叉牌或勾牌阶段时，自动过牌
            if (data.current_player && data.cards && data.cards.length === 0 && !data.can_fork && !data.waiting_for_hook) {
                ws.send(JSON.stringify({action: 'pass'}));
                return;
            }
            
            // 如果在等待勾牌，只显示勾牌和过牌按钮
            if (data.waiting_for_hook) {
                playButton.disabled = true;
                forkButton.style.display = 'none';
                hookButton.style.display = data.can_hook ? 'inline-block' : 'none';
                passButton.disabled = false;  // 始终允许过牌
                
                // if (data.can_hook) {
                //     showMessage('有玩家叉牌，你可以勾牌或过牌', false);
                // } else {
                //     showMessage('有玩家叉牌，请选择是否过牌', false);
                // }
                return;
            }
            
            // 如果可以叉牌，只显示叉牌和过牌按钮
            if (data.can_fork) {
                playButton.disabled = true;
                hookButton.style.display = 'none';
                forkButton.style.display = 'inline-block';
                passButton.disabled = false;  // 允许过牌
                // showMessage('有玩家出单牌，你可以选择叉牌或过牌', false);
                return;
            }
            
            // 正常出牌状态
            playButton.disabled = !data.current_player;
            // 给光机制：如果是给光状态，允许自由出牌
            if (data.is_giving_light) {
                playButton.disabled = !data.current_player;
                passButton.disabled = !data.current_player;
                // showMessage('给光状态：可以自由出牌', false);
            } else {
                passButton.disabled = !data.current_player || !data.last_cards;
            }
            forkButton.style.display = 'none';
            hookButton.style.display = 'none';
            
            if (data.current_player) {
                // 删除提示，直接启用按钮
                enableButtons();
            } else {
                disableButtons();
            }
        }
        
        function displayCards(cards) {
            const cardsContainer = document.getElementById('player-cards');
            cardsContainer.innerHTML = '';
            
            cards.forEach(card => {
                const cardElement = document.createElement('div');
                cardElement.className = 'card' + (isRedCard(card) ? ' red' : '');
                cardElement.textContent = card;
                cardElement.dataset.card = card;
                
                // 添加拖拽属性
                cardElement.draggable = true;
                
                // 拖拽开始事件
                cardElement.addEventListener('dragstart', function(e) {
                    e.dataTransfer.effectAllowed = 'move';
                    e.dataTransfer.setData('text/plain', card);
                    this.classList.add('dragging');
                });
                
                // 拖拽结束事件
                cardElement.addEventListener('dragend', function(e) {
                    this.classList.remove('dragging');
                    document.querySelectorAll('.card-drop-indicator').forEach(el => el.remove());
                });
                
                // 点击选牌事件
                cardElement.addEventListener('click', function(e) {
                    if (this.classList.contains('selected')) {
                        this.classList.remove('selected');
                    } else {
                        const forkButton = document.getElementById('fork');
                        if (forkButton.style.display === 'inline-block') {
                            const selectedCards = document.querySelectorAll('.card.selected');
                            if (selectedCards.length >= 2) {
                                selectedCards[0].classList.remove('selected');
                            }
                        }
                        this.classList.add('selected');
                    }
                    showMessage('', false);
                });
                
                cardsContainer.appendChild(cardElement);
            });
            
            // 为卡牌容器添加拖拽相关事件
            cardsContainer.addEventListener('dragover', function(e) {
                e.preventDefault();
                e.dataTransfer.dropEffect = 'move';
                
                const draggingCard = document.querySelector('.dragging');
                if (!draggingCard) return;
                
                document.querySelectorAll('.card-drop-indicator').forEach(el => el.remove());
                
                const afterElement = getDragAfterElement(this, e.clientX);
                const indicator = document.createElement('div');
                indicator.className = 'card-drop-indicator';
                
                if (afterElement) {
                    const rect = afterElement.getBoundingClientRect();
                    indicator.style.left = (rect.left - 2) + 'px';
                    indicator.style.top = (rect.top - 2) + 'px';
                    this.insertBefore(indicator, afterElement);
                } else {
                    const lastCard = this.lastElementChild;
                    if (lastCard) {
                        const rect = lastCard.getBoundingClientRect();
                        indicator.style.left = (rect.right + 2) + 'px';
                        indicator.style.top = (rect.top - 2) + 'px';
                    }
                    this.appendChild(indicator);
                }
            });
            
            cardsContainer.addEventListener('drop', function(e) {
                e.preventDefault();
                const draggingCard = document.querySelector('.dragging');
                if (!draggingCard) return;
                
                document.querySelectorAll('.card-drop-indicator').forEach(el => el.remove());
                
                const afterElement = getDragAfterElement(this, e.clientX);
                if (afterElement) {
                    this.insertBefore(draggingCard, afterElement);
                } else {
                    this.appendChild(draggingCard);
                }
                
                updateCardsOrder();
            });
        }
        
        // 获取拖拽目标位置的辅助函数
        function getDragAfterElement(container, x) {
            const draggableElements = [...container.querySelectorAll('.card:not(.dragging)')];
            
            // 优化：如果没有其他卡牌，直接返回 null
            if (draggableElements.length === 0) return null;
            
            // 优化：使用二分查找来提高性能
            let start = 0;
            let end = draggableElements.length - 1;
            
            while (start <= end) {
                const mid = Math.floor((start + end) / 2);
                const box = draggableElements[mid].getBoundingClientRect();
                const offset = x - box.left - box.width / 2;
                
                if (offset < 0) {
                    if (mid === 0 || x - draggableElements[mid - 1].getBoundingClientRect().right > 0) {
                        return draggableElements[mid];
                    }
                    end = mid - 1;
                } else {
                    start = mid + 1;
                }
            }
            
            return null;
        }
        
        // 更新手牌顺序的函数
        function updateCardsOrder() {
            const cardsContainer = document.getElementById('player-cards');
            const cards = [];
            cardsContainer.querySelectorAll('.card').forEach(card => {
                cards.push(card.dataset.card);
            });
            
            // 使用防抖来避免频繁发送请求
            if (window.updateOrderTimeout) {
                clearTimeout(window.updateOrderTimeout);
            }
            window.updateOrderTimeout = setTimeout(() => {
                if (ws) {
                    ws.send(JSON.stringify({
                        action: 'update_cards_order',
                        cards: cards
                    }));
                }
            }, 100);  // 100ms 的防抖延迟
        }
        
        function getSelectedCards() {
            const selectedCards = [];
            document.querySelectorAll('.card.selected').forEach(card => {
                selectedCards.push(card.dataset.card);
            });
            return selectedCards;
        }
        
        function handleFork() {
            const selectedCards = getSelectedCards();
            if (selectedCards.length !== 2) {
                showMessage('叉牌需要选中一对牌', true);
                return;
            }
            
            // 检查是否是相同点数的牌
            if (selectedCards[0].slice(1) !== selectedCards[1].slice(1)) {
                showMessage('叉牌必须是相同点数的对子', true);
                return;
            }
            
            ws.send(JSON.stringify({
                'action': 'play_cards',
                'cards': selectedCards
            }));
        }
        
        function handleHook() {
            const selectedCards = getSelectedCards();
            if (selectedCards.length !== 1) {
                showMessage('勾牌需要选中一张牌', true);
                return;
            }
            
            ws.send(JSON.stringify({
                'action': 'play_cards',
                'cards': selectedCards
            }));
        }
        
        function handlePlayCards() {
            const selectedCards = getSelectedCards();
            if (selectedCards.length === 0) {
                showMessage('请选择要出的牌', true);
                return;
            }
            
            ws.send(JSON.stringify({
                'action': 'play_cards',
                'cards': selectedCards
            }));
        }
        
        // 设置按钮事件处理
        document.getElementById('play-cards').onclick = handlePlayCards;
        document.getElementById('pass').onclick = () => {
            ws.send(JSON.stringify({action: 'pass'}));
        };
        document.getElementById('fork').onclick = handleFork;
        document.getElementById('hook').onclick = handleHook;
        
        document.getElementById('join-room').onclick = () => {
            const now = Date.now();
            if (now - lastJoinClickTime < 5000) {
                return;
            }
            lastJoinClickTime = now;
            
            const roomId = document.getElementById('room-id').value;
            if (!roomId) {
                showMessage('请输入房间号');
                return;
            }
            ws = createWebSocketConnection();
            ws.onopen = function() {
                ws.send(JSON.stringify({
                    action: 'join_room',
                    room_id: roomId
                }));
            };
            ws.onerror = function(error) {
                console.error('WebSocket 错误:', error);
                showMessage('连接错误，请刷新页面重试');
            };
            ws.onmessage = function(event) {
                console.log('收到消息:', event.data);
                const data = JSON.parse(event.data);
                
                switch(data.action) {
                    case 'room_created':
                        document.getElementById('room-info').textContent = '房间号：' + data.room_id;
                        document.getElementById('login-section').style.display = 'none';
                        document.getElementById('game-section').style.display = 'block';
                        showMessage('房间创建成功！', false);
                        break;
                        
                    case 'joined_room':
                        if (data.success) {
                            document.getElementById('login-section').style.display = 'none';
                            document.getElementById('game-section').style.display = 'block';
                            document.getElementById('room-info').textContent = '房间号：' + document.getElementById('room-id').value;
                            showMessage('成功加入房间！', false);
                        } else {
                            showMessage(data.message);
                        }
                        break;
                        
                    case 'room_state':
                        playerCount = data.player_count;
                        const roomInfo = document.getElementById('room-info');
                        if (!roomInfo.textContent.includes('玩家')) {
                            roomInfo.textContent += ` (${playerCount}/6 玩家)`;
                        } else {
                            roomInfo.textContent = roomInfo.textContent.replace(/\(\d+\/6 玩家\)/, `(${playerCount}/6 玩家)`);
                        }
                        break;
                        
                    case 'throw_brick':
                        // 接收并显示其他玩家扔砖头的动画
                        showThrowBrickAnimation(data.from_player, data.to_player);
                        break;
                        
                    case 'show_fire':
                        // 接收并显示火焰特效
                        showFireEffect(data.player_index);
                        break;
                        
                    case 'game_state':
                        updateGameState(data);
                        break;
                        
                    case 'game_over':
                        handleGameOver(data);
                        break;
                        
                    case 'show_thanks':
                        alert(data.message);
                        break;
                        
                    case 'error':
                        showMessage(data.message);
                        break;
                }
            };
        };
        
        document.getElementById('start-game').onclick = () => {
            ws.send(JSON.stringify({action: 'start_game'}));
        };
        
        // 修改名称功能
        document.getElementById('change-name').onclick = () => {
            const newName = prompt('请输入新的名称：');
            if (newName && newName.trim()) {
                ws.send(JSON.stringify({
                    action: 'change_name',
                    name: newName.trim()
                }));
            }
        };
        
        // 银姐换装功能
        document.getElementById('change-background').onclick = () => {
            const backgrounds = ['p1.jpg', 'p2.jpg', 'p3.jpg', 'p4.jpg', 'p5.jpg','7.jpg','8.jpg','9.jpg','10.jpg','11.jpg','12.jpg','13.jpg','14.jpg','15.jpg','16.jpg','17.jpg','18.jpg','19.jpg'];
            const randomBg = backgrounds[Math.floor(Math.random() * backgrounds.length)];
            document.body.style.backgroundImage = `url('/static/${randomBg}')`;
            
            // 创建飞出的衣物表情
            const clothes = ['👕', '👖', '👗', '👠', '👢', '👚', '👔', '👒'];
            const button = document.getElementById('change-background');
            const rect = button.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            // 创建6个随机衣物表情
            for (let i = 0; i < 6; i++) {
                const emoji = document.createElement('div');
                emoji.className = 'clothes-emoji';
                emoji.textContent = clothes[Math.floor(Math.random() * clothes.length)];
                
                // 随机飞行方向
                const angle = (Math.PI * 2 * i / 6) + (Math.random() * 0.5 - 0.25);
                const distance = 100 + Math.random() * 50;
                const tx = Math.cos(angle) * distance;
                const ty = Math.sin(angle) * distance;
                
                // 设置初始位置
                emoji.style.left = centerX + 'px';
                emoji.style.top = centerY + 'px';
                emoji.style.setProperty('--tx', `${tx}px`);
                emoji.style.setProperty('--ty', `${ty}px`);
                
                document.body.appendChild(emoji);
                
                // 动画结束后移除元素
                setTimeout(() => emoji.remove(), 1000);
            }
        };
        
        function sendMessage(data) {
            console.log('发送消息:', data);
            ws.send(JSON.stringify(data));
        }
        
        function handleGameOver(data) {
            // 构建游戏结束消息
            let message = '游戏结束！\n\n';
            
            // 添加获胜者信息和积分变化
            message += '获胜者：\n';
            for (let [playerIndex, totalScore, scoreChange] of data.scores.winners) {
                const playerName = data.player_names[playerIndex];
                message += `${playerName}: ${scoreChange >= 0 ? '+' : ''}${scoreChange} 分 (总分: ${totalScore})\n`;
            }
            
            // 添加失败者信息和积分变化
            message += '\n失败者：\n';
            const [loserIndex, loserTotalScore, loserScoreChange] = data.scores.loser;
            const loserName = data.player_names[loserIndex];
            message += `${loserName}: ${loserScoreChange >= 0 ? '+' : ''}${loserScoreChange} 分 (总分: ${loserTotalScore})\n`;
            
            message += '\n可以点击开始游戏按钮开始新的一局';
            
            // 显示游戏结束弹窗
            alert(message);
            
            // 重置游戏状态
            document.getElementById('game-section').style.display = 'block';
            document.getElementById('last-cards').innerHTML = '<h3>上一手牌</h3>无';
            document.getElementById('player-cards').innerHTML = '';
            document.getElementById('player-list').innerHTML = '';
            document.getElementById('start-game').disabled = false;
        }
        
        // 添加扔砖头动画函数
        function showThrowBrickAnimation(fromPlayerIndex, toPlayerIndex) {
            // 获取玩家方框元素
            const fromPlayer = document.querySelector(`.player[data-player-index="${fromPlayerIndex}"]`);
            const toPlayer = document.querySelector(`.player[data-player-index="${toPlayerIndex}"]`);
            
            if (!fromPlayer || !toPlayer) return;
            
            // 创建砖头元素
            const brick = document.createElement('div');
            brick.className = 'brick';
            document.body.appendChild(brick);
            
            // 获取位置信息
            const fromRect = fromPlayer.getBoundingClientRect();
            const toRect = toPlayer.getBoundingClientRect();
            
            // 设置砖头初始位置
            brick.style.left = (fromRect.left + fromRect.width / 2) + 'px';
            brick.style.top = (fromRect.top + fromRect.height / 2) + 'px';
            
            // 计算目标位置
            const targetX = toRect.left + toRect.width / 2;
            const targetY = toRect.top + toRect.height / 2;
            
            // 创建关键帧动画
            const keyframes = [
                {
                    left: brick.style.left,
                    top: brick.style.top,
                    transform: 'scale(0.5) rotate(0deg)'
                },
                {
                    left: targetX + 'px',
                    top: targetY + 'px',
                    transform: 'scale(1) rotate(360deg)'
                }
            ];
            
            // 执行动画
            const animation = brick.animate(keyframes, {
                duration: 500,
                easing: 'ease-out'
            });
            
            // 动画结束后移除砖头元素并显示流泪表情
            animation.onfinish = () => {
                brick.remove();
                
                // 添加抖动效果
                toPlayer.style.animation = 'shake 0.5s';
                setTimeout(() => {
                    toPlayer.style.animation = '';
                }, 500);
                
                // 创建并显示流泪表情
                const cryEmoji = document.createElement('div');
                cryEmoji.className = 'cry-emoji';
                cryEmoji.textContent = '😭';
                toPlayer.appendChild(cryEmoji);
                
                // 1.5秒后移除流泪表情
                setTimeout(() => {
                    cryEmoji.remove();
                }, 1500);
            };
        }
        
        // 添加显示火焰特效的函数
        function showFireEffect(playerIndex) {
            const playerDiv = document.querySelector(`.player[data-player-index="${playerIndex}"]`);
            if (!playerDiv || playerDiv.querySelector('.fire-effect')) return;
            
            // 创建火焰效果
            const fireEffect = document.createElement('div');
            fireEffect.className = 'fire-effect';
            playerDiv.appendChild(fireEffect);
            
            // 创建文字效果
            const hotText = document.createElement('div');
            hotText.className = 'hot-text';
            hotText.textContent = '红温了';
            playerDiv.appendChild(hotText);
            
            // 创建发怒表情
            const angryEmoji = document.createElement('div');
            angryEmoji.className = 'angry-emoji';
            angryEmoji.textContent = '😡';
            playerDiv.appendChild(angryEmoji);
            
            // 2秒后移除所有效果
            setTimeout(() => {
                fireEffect.remove();
                hotText.remove();
                angryEmoji.remove();
            }, 2000);
        }

        document.getElementById('refresh-game').onclick = () => {
            location.reload();
        };
    </script>
</body>
</html>
